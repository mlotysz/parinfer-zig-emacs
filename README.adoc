= parinfer-zig-emacs

Parenthesis inference for Clojure in Emacs, implemented as a native dynamic module in Zig.

== About

This is a fork of https://github.com/eraserhd/parinfer-rust[eraserhd/parinfer-rust], rewritten from Rust to Zig and stripped down to only support Emacs and Clojure. The original project supported Vim, Neovim, Kakoune, WebAssembly, CLI, and multiple Lisp dialects. This fork focuses on doing one thing well.

The Emacs integration is provided via https://github.com/justinbarclay/parinfer-rust-mode[parinfer-rust-mode.el]. This library is a drop-in replacement for the native module it expects.

For background on the fork, see: https://github.com/justinbarclay/parinfer-rust/discussions/9

== Building

Requires https://ziglang.org/[Zig] >= 0.14.0.

....
$ zig build
....

This produces `zig-out/lib/libparinfer_rust.so` (or `.dylib` on macOS).

== Installing

Build the library, then configure `parinfer-rust-mode` to use it:

[source,elisp]
----
(setq parinfer-rust-library "/path/to/parinfer-zig-emacs/zig-out/lib/libparinfer_rust.so")
----

=== Doom Emacs

In `packages.el`:

[source,elisp]
----
(package! parinfer-rust-mode)
----

In `config.el`:

[source,elisp]
----
(setq parinfer-rust-library "/path/to/parinfer-zig-emacs/zig-out/lib/libparinfer_rust.so")
(with-eval-after-load 'parinfer-rust-mode
  (setq parinfer-rust-supported-versions '("0.4.7" "0.5.0")))
----

Then run `doom sync` and restart Emacs.

== Tests

....
$ zig build test               # Unit tests (algorithm, unicode, changes)
$ zig build test-emacs         # Emacs integration tests (requires emacs)
....

== How it works

https://shaunlebron.github.io/parinfer/[Parinfer] infers parentheses from indentation (and vice versa). Three modes:

* *Indent mode* — infers closing parens from indentation
* *Paren mode* — infers indentation from parens
* *Smart mode* — picks the right behavior based on what the user is editing

== Contributors

* Shaun Lebron — invented parinfer
* Jason Felice (eraserhd) — original Rust implementation
* Justin Barclay — parinfer-rust-mode.el
* Case Nelson, Michael Camilleri, Mitsuhiro Nakamura, ElKowar — contributions to the original

== License

link:LICENSE.md[ISC License]
